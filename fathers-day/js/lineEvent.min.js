"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function i(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}}(),_slicedToArray=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(e.push(s.value),!n||e.length!==n);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")};window.lineEvent={data:function(){return{localList:["10.88.110.89","10.88.110.62","10.127.105.69","10.127.105.74","127.0.0.1","localhost"],isInvalid:!0}},computed:{testMode:function(){return"event.franklin.com.tw"!=location.hostname},localMode:function(){return-1<this.localList.indexOf(location.hostname)},apiURL:function(){return this.testMode?"https://wt.franklin.com.tw":"https://event.franklin.com.tw"},idURL:function(){return this.testMode?"https://wt.franklin.com.tw:8081":"https://etrade.franklin.com.tw"},wfURL:function(){return this.testMode?"https://wt.franklin.com.tw":"https://www.franklin.com.tw"}},methods:{testLog:function(t,n){this.testMode&&console.log(t+":",n)},throwError:function(t,n){this.localMode?console.error(n):alert(t)},setPromise:function(t,i,r){return new Promise(function(n,e){$.ajax({type:t,dataType:"json",url:i,data:r,success:function(t){n(t)},error:function(t){e(t)}})})},checkParams:function(r,t){var o=function(){return void 0===t?null:t()},s=["uid","hash","t"],a=this,u="?"+Object.entries(a.getQueryurlParams()).filter(function(t){return s.indexOf(t[0])<0}).map(function(t){var n=_slicedToArray(t,2);return n[0]+"="+n[1]}).join("&"),n=function(){function i(t,n){_classCallCheck(this,i),this.hasParams=t?1:0,this.hasSession=n?1:0;var e=new Array;e[0]=new Array,e[1]=new Array,(this.fun=e)[1][0]=function(){var t={t:a.getQueryurlParams().t,uid:a.getQueryurlParams().uid,hash:a.getQueryurlParams().hash};sessionStorage.setItem(r,JSON.stringify(t)),location.href=location.origin+location.pathname+u},e[1][1]=function(){location.href=location.origin+location.pathname+u},e[0][0]=function(){location.href=a.event_url},e[0][1]=function(){var n=JSON.parse(sessionStorage.getItem(r));s.forEach(function(t){a.config[t]=n[t]}),o&&o()}}return _createClass(i,[{key:"go",value:function(){this.fun[this.hasParams][this.hasSession]()}}]),i}();if(a.localMode)s.forEach(function(t){a.config[t]=a.getQueryurlParams()[t]}),o&&o();else{var e=s.every(function(t){return void 0!==a.getQueryurlParams()[t]}),i=!!sessionStorage.getItem(r);a.testLog("hasAllparams",e),a.testLog("hasSession",i),new n(e,i).go()}},getQueryurlParams:function(){for(var t={},n=window.location.search.substring(1).split("&"),e=0;e<n.length;e++){var i=n[e].split("=");if(void 0===t[i[0]])t[i[0]]=i[1];else if("string"==typeof t[i[0]]){var r=[t[i[0]],i[1]];t[i[0]]=r}else t[i[0]].push(i[1])}return t},resetParams:function(t){return Object.entries(t).map(function(t){var n=_slicedToArray(t,2);return n[0]+"="+n[1]}).join("&")},getQueryParams:function(t){var n=t||location.search;n=n.split("+").join(" ");for(var e,i={},r=/[?&]?([^=]+)=([^&]*)/g;e=r.exec(n);)i[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return i},getLineVerify:function(t){return this.setPromise("GET",this.apiURL+"/LineAPI/api/verify",t)},getLineInfo:function(t){return this.setPromise("GET",this.apiURL+"/LineAPI/api/Analysis",t)},getBinded:function(t){return this.setPromise("GET",this.wfURL+"/FAPI/api/SocialInfo",t)},getBinded_2:function(t){var n=this.resetParams(t);return n&&(n="?"+n),this.setPromise("POST",this.wfURL+"/FAPI/api/SocialInfo"+n,null)},getBCstatus:function(t){return this.setPromise("POST",this.idURL+"/Join/ECStatus",t)},getLinePoint:function(t){return this.setPromise("GET","https://event.franklin.com.tw/LineAPI/api/PointConnect",t)},getWomanBooking:function(t){return this.setPromise("GET",this.wfURL+"/LineAPI/api/CalendarBooking",t)},setWomanBooking:function(t){return this.setPromise("POST",this.wfURL+"/LineAPI/api/CalendarBooking",t)},setDiscount:function(t,n){return this.setPromise("POST",this.idURL+"/Join/Send/"+t,n)},setLineTagging:function(t){return this.setPromise("POST",this.apiURL+"/LineAPI/api/Analysis",t)},setQuestionnaire:function(t){return this.setPromise("POST",this.wfURL+"/FAPI/WF13/AllOther",t)},setWF09:function(t){return this.setPromise("POST",this.wfURL+"/FAPI/WF09/LineEvent",t)},setQuestionWF09:function(t){return this.setPromise("POST",this.wfURL+"/FAPI/wf09/LineEventForm",t)},setBasicWF09:function(t){return this.setPromise("POST",this.wfURL+"/FAPI/WF09/UserFormAPI",t)},setNewWF09:function(t){return this.setPromise("POST",this.wfURL+"/FAPI/EventForm/UserFormAPI",t)}}};