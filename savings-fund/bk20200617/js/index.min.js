"use strict";function _asyncToGenerator(e){return function(){var a=e.apply(this,arguments);return new Promise(function(s,o){return function t(e,n){try{var r=a[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});s(i)}("next")})}}Vue.use(window.vuelidate.default),Vue.use(VueScrollTo);var front={mixins:[valid,window.lineEvent],data:function(){return{config:{event_id:"D2455",event_code:"savings-fund",start_date:"2020-06-10 18:00:00",end_date:"2020-06-30 10:00:00",uid:"",t:"",hash:"",isBinded:999},isSubmit:!1,isDone:!1,loginType:2,temp:{ID_NO:"",BF_NAME:"",CELL_PHONE:"",EMAIL:""},form:{ID_NO:"",PASS_WORD:"",BF_NAME:"",CELL_PHONE:"",EMAIL:"",AGREE:!1}}},computed:{login_id_no:{get:function(){return this.form.ID_NO},set:function(e){this.form.ID_NO=e?e.toUpperCase():""}},covered_id_no:function(){var e="";return this.form.ID_NO&&(e=this.form.ID_NO.substr(0,3)+"XXXXX"+this.form.ID_NO.substr(8,10)),e},event_url:function(){return this.testMode?"https://line.franklin.com.tw:8443/Tag/Bind/DR?id=savingreservation":"https://line.franklin.com.tw:8843/Tag/Bind/DR?id=savingreservation"},isLine:function(){return"linem"==this.getQueryParams().utm_source},wf09Data:function(){var e={Event_Id:this.config.event_id,IsRepeatable:"N"};return this.getQueryParams().utm_source&&(e.utm_source=this.getQueryParams().utm_source),this.isLine&&(e.uid=this.config.uid),1==this.config.isBinded?e.Identification="":(e.Identification=this.form.ID_NO==this.temp.ID_NO?"":this.form.ID_NO,1==this.loginType?e.Event_Other="-1":2==this.loginType&&(e.Friend_Name=this.form.BF_NAME==this.temp.BF_NAME?"":this.form.BF_NAME,e.Email=this.form.EMAIL==this.temp.EMAIL?"":this.form.EMAIL,e.M_Tel=this.form.CELL_PHONE==this.temp.CELL_PHONE?"":this.form.CELL_PHONE)),e},isPart2:function(){return!!this.testMode||moment(new Date).isSameOrAfter(this.config.start_date)},isEnd:function(){return!this.testMode&&moment(new Date).isSameOrAfter(this.config.end_date)}},created:function(){this.isEnd?location.href="https://event.franklin.com.tw/activityEnds/event-end.html":this.isLine&&!this.isEnd&&this.isPart2&&this.checkLineParams()},methods:{checkLineParams:function(){var e=this;this.checkParams(this.config.event_code,function(){e.getInfo(),e.testLog("url","https://wt.franklin.com.tw/areas/"+e.config.event_code+"/index.html?utm_source="+e.getQueryParams().utm_source+"&uid="+e.config.uid+"&t="+e.config.t+"&hash="+e.config.hash)})},getInfo:function(){var s=this;return _asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.isSubmit){e.next=2;break}return e.abrupt("return");case 2:return s.isSubmit=!0,e.prev=3,e.prev=4,e.next=7,s.getLineVerify({uid:s.config.uid,timestamp:s.config.t,hash:s.config.hash});case 7:if(t=e.sent,s.testLog("verify",t),!t){e.next=19;break}return e.next=12,s.getBinded_2({CodeSecret:md5(s.config.uid+"D2444"),UID:s.config.uid});case 12:n=e.sent,s.testLog("bind",n),r=[1,2,4],s.config.isBinded=-1<r.indexOf(n.status)?n.status:4,s.$nextTick(function(){1==s.config.isBinded?s.form.ID_NO=n.memo:2==s.config.isBinded&&(s.temp.ID_NO=n.memo||"",s.temp.BF_NAME=n.Friend_Name||"",s.temp.CELL_PHONE=n.M_Tel||"",s.temp.EMAIL=n.Email||"",s.form.ID_NO=n.memo||"",s.form.BF_NAME=n.Friend_Name||"",s.form.CELL_PHONE=n.M_Tel||"",s.form.EMAIL=n.Email||"")}),e.next=20;break;case 19:location.href=s.event_url;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(4),i=e.t0?e.t0:"\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01",s.throwError(i+" info",""+e.t0);case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(3),s.throwError("\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01 other",e.t1);case 31:return e.prev=31,s.isSubmit=!1,e.finish(31);case 34:case"end":return e.stop()}},e,s,[[3,28,31,34],[4,22]])}))()},sendForm:function(){var r=this;return _asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isEnd){e.next=3;break}return alert("\u6b64\u6d3b\u52d5\u5df2\u7d93\u7d50\u675f\uff0c\u672a\u4f86\u5c07\u4e0d\u5b9a\u671f\u63d0\u4f9b\u66f4\u591a\u6700\u5373\u6642\u7684\u5e02\u5834\u3001\u597d\u5eb7\u8a0a\u606f\uff0c\u8acb\u6301\u7e8c\u95dc\u6ce8\u6211\u5011\u5594\uff01"),e.abrupt("return");case 3:if(!r.$v.form.$invalid){e.next=8;break}r.$v.form.$touch(),r.$nextTick(function(){var e=document.querySelectorAll(".formArea-item.error")[0];r.$scrollTo(e)}),e.next=42;break;case 8:if(!r.isSubmit){e.next=10;break}return e.abrupt("return");case 10:return r.isSubmit=!0,e.next=13,new Promise(function(e){r.$nextTick(function(){setTimeout(function(){e()},333)})});case 13:e.prev=13,r.testLog("mode",r.isLine?"line":"basic"),t={rtcode:"0"},e.t0=t.rtcode,e.next="0"===e.t0?19:32;break;case 19:if(!r.isLine){e.next=25;break}return e.next=22,r.setQuestionWF09(r.wf09Data);case 22:e.t1=e.sent,e.next=28;break;case 25:return e.next=27,r.setNewWF09(r.wf09Data);case 27:e.t1=e.sent;case 28:return n=e.t1,r.testLog((r.isLine?"line-":"")+"wf09",n),"1"==n.status.toString()?(r.isDone=!0,r.$nextTick(function(){r.$scrollTo("#complete")})):r.throwError(n.memo,n),e.abrupt("break",34);case 32:return r.throwError(t.message,t),e.abrupt("break",34);case 34:e.next=39;break;case 36:e.prev=36,e.t2=e.catch(13),r.throwError("\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01",e.t2);case 39:return e.prev=39,r.isSubmit=!1,e.finish(39);case 42:case"end":return e.stop()}},e,r,[[13,36,39,42]])}))()},lineAlert:function(){alert("\u7533\u8acbLINE\u5b98\u65b9\u5e33\u865f\u7d81\u5b9a\u670d\u52d9\u6642\uff0c\u5bcc\u862d\u514b\u6797\u5c07\u6839\u64da\u4f60\u63d0\u4f9b\u7684\u59d3\u540d\u3001\u884c\u52d5\u96fb\u8a71\u8207LINE\u5e33\u865f\u9032\u884c\u8eab\u5206\u9a57\u8b49\uff0c\u672c\u67e5\u8a62\u53ca\u9a57\u8b49\u670d\u52d9\u65bc\u5bcc\u862d\u514b\u6797\u7cfb\u7d71\u57f7\u884c\uff0c\u4e0d\u6703\u7d93\u7531LINE\u8a18\u9304\u8cc7\u6599\u3002\n\n\u6210\u529f\u7d81\u5b9a\u500b\u4eba\u5316\u670d\u52d9\u5f8c\uff0c \u82e5\u66f4\u63db\u624b\u6a5f\u6216\u91cd\u65b0\u5b89\u88ddLINE APP\uff0c \u9700\u4ee5\u539f\u672cLINE ID\u767b\u5165\uff0c \u4ee5\u5229\u5f8c\u7e8cLINE\u500b\u4eba\u5316\u670d\u52d9\u4f7f\u7528\u3002 ")}}};