"use strict";function _asyncToGenerator(t){return function(){var a=t.apply(this,arguments);return new Promise(function(s,o){return function e(t,n){try{var r=a[t](n),i=r.value}catch(t){return void o(t)}if(!r.done)return Promise.resolve(i).then(function(t){e("next",t)},function(t){e("throw",t)});s(i)}("next")})}}Vue.use(window.vuelidate.default),Vue.use(VueScrollTo);var front={mixins:[valid,window.lineEvent],data:function(){return{config:{event_id:"L0008",event_code:"savings-fund",event_sub:"quiz",start_date:"2020-06-10 18:00:00",end_date:"2020-07-01 10:00:00",uid:"",t:"",hash:"",isBinded:999},question:[{title:"\u5b58\u7684\u610f\u7fa9\u662f...",answer:[{word:"\u771f\u6b63\u300e\u5b58\u300f1\u584a\u9322\u624d\u662f\u5b58",value:"1"},{word:"\u8cfa\u7684\u90fd\u53ef\u4ee5\u53eb\u505a\u300e\u5b58\u300f",value:"2"},{word:"\u5e74\u9577\u7684\u4eba\u624d\u9700\u8981\u300e\u5b58\u300f",value:"3"}]},{title:"\u6700\u9069\u5408\u300e\u5b58\u300f\u7684\u6295\u8cc7\u5de5\u5177...",answer:[{word:"\u57fa\u91d1",value:"1"},{word:"\u80a1\u7968",value:"2"},{word:"\u5b9a\u5b58",value:"3"}]},{title:"\u4ec0\u9ebc\u6bd4\u5831\u916c\u7387\u66f4\u91cd\u8981\u5462\uff1f...",answer:[{word:"\u7d00\u5f8b",value:"1"},{word:"\u672c\u91d1",value:"2"},{word:"\u624b\u7e8c\u8cbb",value:"3"}]}],answer:"",step:1,isStart:!1,isCompleted:!1,isError:!1,isSubmit:!1,isDone:!1,loginType:2,temp:{ID_NO:"",BF_NAME:"",CELL_PHONE:"",EMAIL:""},form:{ID_NO:"",PASS_WORD:"",BF_NAME:"",CELL_PHONE:"",EMAIL:"",AGREE:!1}}},computed:{login_id_no:{get:function(){return this.form.ID_NO},set:function(t){this.form.ID_NO=t?t.toUpperCase():""}},covered_id_no:function(){var t="";return this.form.ID_NO&&(t=this.form.ID_NO.substr(0,3)+"XXXXX"+this.form.ID_NO.substr(8,10)),t},event_url:function(){return this.testMode?"https://line.franklin.com.tw:8443/Tag/Bind/DR?id=savingquiz":"https://line.franklin.com.tw:8843/Tag/Bind/DR?id=savingquiz"},wf09Data:function(){var t={Event_Id:this.config.event_id,IsRepeatable:"N"};return this.getQueryParams().utm_source&&(t.utm_source=this.getQueryParams().utm_source),this.isLine&&(t.uid=this.config.uid),1==this.config.isBinded?t.Identification="":(t.Identification=this.form.ID_NO==this.temp.ID_NO?"":this.form.ID_NO,1==this.loginType?t.Event_Other="-1":2==this.loginType&&(t.Friend_Name=this.form.BF_NAME==this.temp.BF_NAME?"":this.form.BF_NAME,t.Email=this.form.EMAIL==this.temp.EMAIL?"":this.form.EMAIL,t.M_Tel=this.form.CELL_PHONE==this.temp.CELL_PHONE?"":this.form.CELL_PHONE)),t},isLine:function(){return!this.testMode||"linem"==this.getQueryParams().utm_source},isEnd:function(){return!this.testMode&&moment(new Date).isSameOrAfter(this.config.end_date)}},created:function(){this.isEnd?location.href="https://event.franklin.com.tw/activityEnds/event-end.html":this.isLine&&!this.isEnd&&this.checkLineParams()},methods:{start:function(){var t=this;this.isStart=!0,this.$nextTick(function(){t.$scrollTo("#start")})},checkAnswer:function(){this.answer?1==this.answer?this.next():this.prev():this.$scrollTo(".quiz")},prev:function(){var t=this;this.isError=!0,this.$nextTick(function(){t.$scrollTo(".diamondBg")})},next:function(){var t=this;if(3==this.step)return this.isCompleted=!0,void this.$nextTick(function(){t.$scrollTo(".completeQuestionnaire")});var e=this;this.$scrollTo("#start",{onDone:function(){e.answer="",e.step+=1}})},reset:function(){this.isError=!1,this.answer="",this.$scrollTo("#start")},checkLineParams:function(){var t=this;this.checkParams(this.config.event_code,function(){t.getInfo(),t.testLog("url","https://wt.franklin.com.tw/areas/"+t.config.event_code+"/"+t.config.event_sub+".html?utm_source="+t.getQueryParams().utm_source+"&uid="+t.config.uid+"&t="+t.config.t+"&hash="+t.config.hash)})},getInfo:function(){var s=this;return _asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!s.isSubmit){t.next=2;break}return t.abrupt("return");case 2:return s.isSubmit=!0,t.prev=3,t.prev=4,t.next=7,s.getLineVerify({uid:s.config.uid,timestamp:s.config.t,hash:s.config.hash});case 7:if(e=t.sent,s.testLog("verify",e),!e){t.next=19;break}return t.next=12,s.getBinded_2({CodeSecret:md5(s.config.uid+"D2444"),UID:s.config.uid});case 12:n=t.sent,s.testLog("bind",n),r=[1,2,4],s.config.isBinded=-1<r.indexOf(n.status)?n.status:4,s.$nextTick(function(){1==s.config.isBinded?s.form.ID_NO=n.memo:2==s.config.isBinded&&(s.temp.ID_NO=n.memo||"",s.temp.BF_NAME=n.Friend_Name||"",s.temp.CELL_PHONE=n.M_Tel||"",s.temp.EMAIL=n.Email||"",s.form.ID_NO=n.memo||"",s.form.BF_NAME=n.Friend_Name||"",s.form.CELL_PHONE=n.M_Tel||"",s.form.EMAIL=n.Email||"")}),t.next=20;break;case 19:location.href=s.event_url;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(4),i=t.t0?t.t0:"\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01",s.throwError(i+" info",""+t.t0);case 26:t.next=31;break;case 28:t.prev=28,t.t1=t.catch(3),s.throwError("\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01 other",t.t1);case 31:return t.prev=31,s.isSubmit=!1,t.finish(31);case 34:case"end":return t.stop()}},t,s,[[3,28,31,34],[4,22]])}))()},sendForm:function(){var r=this;return _asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.isEnd){t.next=3;break}return alert("\u6b64\u6d3b\u52d5\u5df2\u7d93\u7d50\u675f\uff0c\u672a\u4f86\u5c07\u4e0d\u5b9a\u671f\u63d0\u4f9b\u66f4\u591a\u6700\u5373\u6642\u7684\u5e02\u5834\u3001\u597d\u5eb7\u8a0a\u606f\uff0c\u8acb\u6301\u7e8c\u95dc\u6ce8\u6211\u5011\u5594\uff01"),t.abrupt("return");case 3:if(!r.$v.form.$invalid){t.next=8;break}r.$v.form.$touch(),r.$nextTick(function(){var t=document.querySelectorAll(".formArea-item.error")[0];r.$scrollTo(t)}),t.next=42;break;case 8:if(!r.isSubmit){t.next=10;break}return t.abrupt("return");case 10:return r.isSubmit=!0,t.next=13,new Promise(function(t){r.$nextTick(function(){setTimeout(function(){t()},333)})});case 13:t.prev=13,r.testLog("mode",r.isLine?"line":"basic"),e={rtcode:"0"},t.t0=e.rtcode,t.next="0"===t.t0?19:32;break;case 19:if(!r.isLine){t.next=25;break}return t.next=22,r.setQuestionWF09(r.wf09Data);case 22:t.t1=t.sent,t.next=28;break;case 25:return t.next=27,r.setNewWF09(r.wf09Data);case 27:t.t1=t.sent;case 28:return n=t.t1,r.testLog((r.isLine?"line-":"")+"wf09",n),"1"==n.status.toString()?(r.isDone=!0,r.$nextTick(function(){r.$scrollTo("#complete")})):r.throwError(n.memo,n),t.abrupt("break",34);case 32:return r.throwError(e.message,e),t.abrupt("break",34);case 34:t.next=39;break;case 36:t.prev=36,t.t2=t.catch(13),r.throwError("\u7cfb\u7d71\u7e41\u5fd9\uff0c\u8acb\u7a0d\u5019\u518d\u8a66\uff0c\u8b1d\u8b1d\uff01",t.t2);case 39:return t.prev=39,r.isSubmit=!1,t.finish(39);case 42:case"end":return t.stop()}},t,r,[[13,36,39,42]])}))()},lineAlert:function(){alert("\u7533\u8acbLINE\u5b98\u65b9\u5e33\u865f\u7d81\u5b9a\u670d\u52d9\u6642\uff0c\u5bcc\u862d\u514b\u6797\u5c07\u6839\u64da\u4f60\u63d0\u4f9b\u7684\u59d3\u540d\u3001\u884c\u52d5\u96fb\u8a71\u8207LINE\u5e33\u865f\u9032\u884c\u8eab\u5206\u9a57\u8b49\uff0c\u672c\u67e5\u8a62\u53ca\u9a57\u8b49\u670d\u52d9\u65bc\u5bcc\u862d\u514b\u6797\u7cfb\u7d71\u57f7\u884c\uff0c\u4e0d\u6703\u7d93\u7531LINE\u8a18\u9304\u8cc7\u6599\u3002\n\n\u6210\u529f\u7d81\u5b9a\u500b\u4eba\u5316\u670d\u52d9\u5f8c\uff0c \u82e5\u66f4\u63db\u624b\u6a5f\u6216\u91cd\u65b0\u5b89\u88ddLINE APP\uff0c \u9700\u4ee5\u539f\u672cLINE ID\u767b\u5165\uff0c \u4ee5\u5229\u5f8c\u7e8cLINE\u500b\u4eba\u5316\u670d\u52d9\u4f7f\u7528\u3002 ")}}};